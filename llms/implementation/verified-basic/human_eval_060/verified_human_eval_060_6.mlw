module HumanEval060
  use int.Int
  use list.List
  use list.Sum

  predicate sum (n : int) (a : int)
    axiom sum_zero :
        forall a. sum 0 a <-> a = 0
    axiom sum_ind :
        forall a n . sum n a <-> exists b. sum (n-1) b /\ a = b + n   

  let rec make_list (a: int) (b: int) : list int
    ensures { forall i:int. 0 <= i < length result -> nth result i = a + i }
    ensures { length result = (if a > b then 0 else b - a + 1) }
    variant { if a > b then 0 else b - a + 1 }
    = if a > b then Nil else Cons a (make_list (a + 1) b)

  (* Lemma: The sum of the list generated by make_list 1 n is the sum from 1 to n *)
  lemma sum_of_make_list:
    forall n:int. n >= 0 ->
      sum n (sum (make_list 1 n))

  let sum_to_n (n: int) : int =
    ensures { sum n result }
    sum (make_list 1 n)
end
