module HumanEval152
  use int.Int
  use int.Abs
  use list.List
  use list.Length
  use list.NthNoOpt

  let absdiff (a:int) (b:int) : int
    ensures { result = (if a = b then 0 else abs (a - b)) }
    ensures { result >= 0 }
    = if a = b then 0 else abs (a - b)

  let rec compare (l1 : list int) (l2 : list int) : list int
    requires { length l1 = length l2 }
    ensures { length result = length l1 }
    ensures { length l1 = length l2 }
    ensures { forall i: int. 0 <= i < length l1 -> nth i result = abs (nth i l1 - nth i l2)}
    variant { length l1 }
    = match l1, l2 with
      | Nil, Nil -> Nil
      | Cons x xs, Cons y ys -> Cons (absdiff x y) (compare xs ys)
      | _, _ -> Nil
      end
end
