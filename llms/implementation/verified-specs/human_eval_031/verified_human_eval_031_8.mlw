module HumanEval031
  use int.Int
  use int.EuclideanDivision

  let is_prime (n: int) : bool =
    ensures { result <-> (n >= 2 /\ forall d: int. 2 <= d /\ d < n -> not (mod n d = 0)) }
    if n <= 1 then false else
    let ref found = false in
    let ref d = 2 in
    while d < n && not found do
      invariant { 2 <= d <= n /\
                  (forall k: int. 2 <= k < d -> not (mod n k = 0)) /\
                  (found <-> exists k: int. 2 <= k < d /\ mod n k = 0) }
      variant { n - d }
      if mod n d = 0 then found <- true;
      d <- d + 1
    done;
    not found
end
