(*
def is_prime(n):
    """Return true if a given number is prime, and false otherwise.
    >>> is_prime(6)
    False
    >>> is_prime(101)
    True
    >>> is_prime(11)
    True
    >>> is_prime(13441)
    True
    >>> is_prime(61)
    True
    >>> is_prime(4)
    False
    >>> is_prime(1)
    False
    """
 *)


module HumanEval031Goal

    use int.Int
    use int.EuclideanDivision
    
    let is_prime (n : int) : bool =
        if n <= 2 then false
        else
            let ref flag = true in
            for i = 2 to n - 1 do
                if mod n i = 0 
                then flag <- false
            done ;
            flag
end

(* INSERT_CHATGPT_CODE *)

module HumanEval031

  use int.Int
  use list.List
  use list.Length

  let is_prime (n : int) : bool =
    requires { n > 0 }
    if n <= 1 then false
    else
      let rec mark_non_primes (l : list int) (i : int) : list int =
        match l with
        | Nil -> Nil
        | Cons x xs -> if x mod i = 0 && x <> i then mark_non_primes xs i else Cons x (mark_non_primes xs i)
        end
      in
      let rec sieve (l : list int) : list int =
        match l with
        | Nil -> Nil
        | Cons x xs -> Cons x (sieve (mark_non_primes xs x))
        end
      in
      let primes = sieve (Cons 2 (Cons 3 (Cons 4 (Cons 5 (Cons 6 (Cons 7 (Cons 8 (Cons 9 (Cons 10 Nil))))))))) in
      let rec is_prime (l : list int) : bool =
        match l with
        | Nil -> false
        | Cons x xs -> if x = n then true else is_prime xs
        end
      in
      is_prime primes

end


module TestHumanEval031
    use int.Int
    use list.List
    use HumanEval031

    let test1 () : bool =
        not is_prime 6

    let test1_output () : (int, bool, bool) =
        (6, is_prime 6, false)

    let test2 () : bool =
        is_prime 101

    let test2_output () : (int, bool, bool) =
        (101, is_prime 101, true)

    let test3 () : bool =
        is_prime 11

    let test3_output () : (int, bool, bool) =
        (11, is_prime 11, true)

    let test4 () : bool =
        is_prime 13441

    let test4_output () : (int, bool, bool) =
        (13441, is_prime 13441, true)

    let test5 () : bool =
        is_prime 61

    let test5_output () : (int, bool, bool) =
        (61, is_prime 61, true)

    let test6 () : bool =
        not is_prime 4

    let test6_output () : (int, bool, bool) =
        (4, is_prime 4, false)

    let test7 () : bool =
        not is_prime 1

    let test7_output () : (int, bool, bool) =
        (1, is_prime 1, false)

    let testall () : bool =
        test1() && test2() && test3() && test4() && test5() && test6() && test7()

    let testfail () : list int =
        let ref res = Nil in 
        if not test1() then res <- Cons 1 res;
        if not test2() then res <- Cons 2 res;
        if not test3() then res <- Cons 3 res;
        if not test4() then res <- Cons 4 res;
        if not test5() then res <- Cons 5 res;
        if not test6() then res <- Cons 6 res;
        if not test7() then res <- Cons 7 res;
        res

    let runtest (x : int) : (int, bool, bool) =
        let ref res = (0, false, false) in
        if x = 1 then res <- test1_output();
        if x = 2 then res <- test2_output();
        if x = 3 then res <- test3_output();
        if x = 4 then res <- test4_output();
        if x = 5 then res <- test5_output();
        if x = 6 then res <- test6_output();
        if x = 7 then res <- test7_output();
        res

    let rec failoutput (l : list int) : list (int, bool, bool) =
        match l with
        | Nil -> Nil
        | Cons x xs -> Cons (runtest x) (failoutput xs)
        end

    let test () : list (int, bool, bool) =
        let l = testfail () in
        failoutput l

end
