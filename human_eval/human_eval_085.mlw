(*
def add(lst):
    """Given a non-empty list of integers lst. add the even elements that are at odd indices..


    Examples:
        add([4, 2, 6, 7]) ==> 2
    """
*)

module HumanEval085
    
    use int.Int
    use list.List
    use list.NthNoOpt
    use int.EuclideanDivision
    use list.Length

    let rec nth_1 (n : int) (l : list int) : int =
        requires { length l > 0 }
        requires { 0 <= n /\ n < length l }
        variant { n }
        ensures { nth n l = result }
        match l with 
        | Cons x r -> if n = 0 then x else nth_1 (n - 1) r
        end 

    let add (l : list int) : int =
        let n = length l in 
        let ref res = 0 in 
        for i = 0 to n - 1 do 
            let elem = nth_1 i l in 
            if mod i 2 = 1 && mod elem 2 = 0 
            then res <- res + elem
        done ;
        res
end